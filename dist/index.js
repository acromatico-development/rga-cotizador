// import axios from "axios";
let $f0d540db358c20b7$export$f566b60ae4e8e0b3;
(function(EstadoEnGarantia) {
    EstadoEnGarantia[EstadoEnGarantia["Aguascalientes"] = 500] = "Aguascalientes";
    EstadoEnGarantia[EstadoEnGarantia["Baja California"] = 3350] = "Baja California";
    EstadoEnGarantia[EstadoEnGarantia["Baja California Sur"] = 3350] = "Baja California Sur";
    EstadoEnGarantia[EstadoEnGarantia["Campeche"] = 575] = "Campeche";
    EstadoEnGarantia[EstadoEnGarantia["Chiapas"] = 500] = "Chiapas";
    EstadoEnGarantia[EstadoEnGarantia["Chihuahua"] = 500] = "Chihuahua";
    EstadoEnGarantia[EstadoEnGarantia["Ciudad de M\xe9xico"] = 500] = "Ciudad de M\xe9xico";
    EstadoEnGarantia[EstadoEnGarantia["Coahuila de Zaragoza"] = 500] = "Coahuila de Zaragoza";
    EstadoEnGarantia[EstadoEnGarantia["Colima"] = 500] = "Colima";
    EstadoEnGarantia[EstadoEnGarantia["Durango"] = 575] = "Durango";
    EstadoEnGarantia[EstadoEnGarantia["Guanajuato"] = 500] = "Guanajuato";
    EstadoEnGarantia[EstadoEnGarantia["Guerrero"] = 2050] = "Guerrero";
    EstadoEnGarantia[EstadoEnGarantia["Hidalgo"] = 1050] = "Hidalgo";
    EstadoEnGarantia[EstadoEnGarantia["Jalisco"] = 690] = "Jalisco";
    EstadoEnGarantia[EstadoEnGarantia["M\xe9xico"] = 500] = "M\xe9xico";
    EstadoEnGarantia[EstadoEnGarantia["Michoac\xe1n de Ocampo"] = 1950] = "Michoac\xe1n de Ocampo";
    EstadoEnGarantia[EstadoEnGarantia["Morelos"] = 500] = "Morelos";
    EstadoEnGarantia[EstadoEnGarantia["Nayarit"] = 500] = "Nayarit";
    EstadoEnGarantia[EstadoEnGarantia["Nuevo Le\xf3n"] = 575] = "Nuevo Le\xf3n";
    EstadoEnGarantia[EstadoEnGarantia["Oaxaca"] = 575] = "Oaxaca";
    EstadoEnGarantia[EstadoEnGarantia["Puebla"] = 1800] = "Puebla";
    EstadoEnGarantia[EstadoEnGarantia["Quer\xe9taro"] = 500] = "Quer\xe9taro";
    EstadoEnGarantia[EstadoEnGarantia["Quintana Roo"] = 1200] = "Quintana Roo";
    EstadoEnGarantia[EstadoEnGarantia["San Luis Potos\xed"] = 2200] = "San Luis Potos\xed";
    EstadoEnGarantia[EstadoEnGarantia["Sinaloa"] = 3200] = "Sinaloa";
    EstadoEnGarantia[EstadoEnGarantia["Sonora"] = 3000] = "Sonora";
    EstadoEnGarantia[EstadoEnGarantia["Tabasco"] = 575] = "Tabasco";
    EstadoEnGarantia[EstadoEnGarantia["Tamaulipas"] = 575] = "Tamaulipas";
    EstadoEnGarantia[EstadoEnGarantia["Tlaxcala"] = 1450] = "Tlaxcala";
    EstadoEnGarantia[EstadoEnGarantia["Veracruz de Ignacio de la Llave"] = 3200] = "Veracruz de Ignacio de la Llave";
    EstadoEnGarantia[EstadoEnGarantia["Yucat\xe1n"] = 3350] = "Yucat\xe1n";
    EstadoEnGarantia[EstadoEnGarantia["Zacatecas"] = 575] = "Zacatecas";
})($f0d540db358c20b7$export$f566b60ae4e8e0b3 || ($f0d540db358c20b7$export$f566b60ae4e8e0b3 = {}));
let $f0d540db358c20b7$export$4d1c8da1ae941898;
(function(EstadoFirma) {
    EstadoFirma[EstadoFirma["Aguascalientes"] = 5000] = "Aguascalientes";
    EstadoFirma[EstadoFirma["Baja California"] = 5000] = "Baja California";
    EstadoFirma[EstadoFirma["Baja California Sur"] = 5000] = "Baja California Sur";
    EstadoFirma[EstadoFirma["Campeche"] = 5000] = "Campeche";
    EstadoFirma[EstadoFirma["Chiapas"] = 5000] = "Chiapas";
    EstadoFirma[EstadoFirma["Chihuahua"] = 5000] = "Chihuahua";
    EstadoFirma[EstadoFirma["Ciudad de M\xe9xico"] = 300] = "Ciudad de M\xe9xico";
    EstadoFirma[EstadoFirma["Coahuila de Zaragoza"] = 5000] = "Coahuila de Zaragoza";
    EstadoFirma[EstadoFirma["Colima"] = 5000] = "Colima";
    EstadoFirma[EstadoFirma["Durango"] = 5000] = "Durango";
    EstadoFirma[EstadoFirma["Guanajuato"] = 5000] = "Guanajuato";
    EstadoFirma[EstadoFirma["Guerrero"] = 5000] = "Guerrero";
    EstadoFirma[EstadoFirma["Hidalgo"] = 5000] = "Hidalgo";
    EstadoFirma[EstadoFirma["Jalisco"] = 5000] = "Jalisco";
    EstadoFirma[EstadoFirma["M\xe9xico"] = 350] = "M\xe9xico";
    EstadoFirma[EstadoFirma["Michoac\xe1n de Ocampo"] = 5000] = "Michoac\xe1n de Ocampo";
    EstadoFirma[EstadoFirma["Morelos"] = 5000] = "Morelos";
    EstadoFirma[EstadoFirma["Nayarit"] = 5000] = "Nayarit";
    EstadoFirma[EstadoFirma["Nuevo Le\xf3n"] = 5000] = "Nuevo Le\xf3n";
    EstadoFirma[EstadoFirma["Oaxaca"] = 5000] = "Oaxaca";
    EstadoFirma[EstadoFirma["Puebla"] = 500] = "Puebla";
    EstadoFirma[EstadoFirma["Quer\xe9taro"] = 5000] = "Quer\xe9taro";
    EstadoFirma[EstadoFirma["Quintana Roo"] = 5000] = "Quintana Roo";
    EstadoFirma[EstadoFirma["San Luis Potos\xed"] = 5000] = "San Luis Potos\xed";
    EstadoFirma[EstadoFirma["Sinaloa"] = 5000] = "Sinaloa";
    EstadoFirma[EstadoFirma["Sonora"] = 5000] = "Sonora";
    EstadoFirma[EstadoFirma["Tabasco"] = 5000] = "Tabasco";
    EstadoFirma[EstadoFirma["Tamaulipas"] = 5000] = "Tamaulipas";
    EstadoFirma[EstadoFirma["Tlaxcala"] = 5000] = "Tlaxcala";
    EstadoFirma[EstadoFirma["Veracruz de Ignacio de la Llave"] = 5000] = "Veracruz de Ignacio de la Llave";
    EstadoFirma[EstadoFirma["Yucat\xe1n"] = 5000] = "Yucat\xe1n";
    EstadoFirma[EstadoFirma["Zacatecas"] = 5000] = "Zacatecas";
})($f0d540db358c20b7$export$4d1c8da1ae941898 || ($f0d540db358c20b7$export$4d1c8da1ae941898 = {}));
let $f0d540db358c20b7$export$8250b6f35bc15c68;
(function(NivelCobertura) {
    NivelCobertura["lite"] = "Lite";
    NivelCobertura["alpha"] = "Alpha";
    NivelCobertura["alphaPlus"] = "Alpha Plus";
})($f0d540db358c20b7$export$8250b6f35bc15c68 || ($f0d540db358c20b7$export$8250b6f35bc15c68 = {}));
let $f0d540db358c20b7$export$6e7b439551acada7;
(function(Coberturas) {
    Coberturas["investigacionRpp"] = "Investigacion RPP";
    Coberturas["seguro"] = "Seguro";
    Coberturas["firmaDeContrato"] = "Firma de Contrat";
    Coberturas["investigacionRG"] = "Investigaci\xf3n RG";
    Coberturas["gestionExtrajudicial"] = "Gestion Extrajudicial";
    Coberturas["recuperacionInmueble"] = "Recuperacion de Inmueble";
    Coberturas["recuperacionDeAdeudos"] = "Recuperacion de Adeudos";
})($f0d540db358c20b7$export$6e7b439551acada7 || ($f0d540db358c20b7$export$6e7b439551acada7 = {}));
// TO DO: Bu
const $f0d540db358c20b7$var$permitedCities = [
    "Canc\xfan",
    "Ciudad de M\xe9xico",
    "Cuernavaca",
    "Guadalajara",
    "Zapopan",
    "Tlaquepaque",
    "M\xe9rida",
    "Monterrey",
    "San Pedro Garza Garc\xeda",
    "Pachuca de Soto",
    "Heroica Puebla de Zaragoza",
    "Santiago de Quer\xe9taro"
];
class $f0d540db358c20b7$export$3bbcb4831e58d00d {
    constructor(renta, cp, estadoFirma, nivelCobertura){
        this.renta = renta;
        this.resolved = new Promise(async (resolve)=>{
            const cpData = await this.getCpData(cp);
            console.log("cp", cpData);
            const permitido = $f0d540db358c20b7$var$permitedCities.find((city)=>city === cpData.ciudad);
            if (!permitido) {
                const edomex = cpData.estado === "M\xe9xico";
                if (!edomex) {
                    console.log("No se encontr\xf3 la ciudad");
                    throw new Error("No se encontr\xf3 la ciudad");
                }
            }
            this.estadoGarantia = $f0d540db358c20b7$export$f566b60ae4e8e0b3[cpData.estado] ? $f0d540db358c20b7$export$f566b60ae4e8e0b3[cpData.estado] : $f0d540db358c20b7$export$f566b60ae4e8e0b3["Ciudad de M\xe9xico"];
            this.estadoFirma = estadoFirma ? estadoFirma : $f0d540db358c20b7$export$4d1c8da1ae941898["Ciudad de M\xe9xico"];
            //TO DO: traer variables de fuente externa
            this._investigacionRg = 21;
            this._perfilRiesgoIncumplimiento = 0.2;
            this._perfilRiesgoJuicioRecuperacion = 0.025;
            this._perfilRiesgoJuicioAdeudos = 0.025;
            //TO DO: traer constantes de fuente externa
            this._factorInvestigacion = 1;
            this._factorSeguro = 0.1308;
            this._factorFirma = 1;
            this._factorSolvencia = 1;
            this._factorIncumplimiento = 180;
            this._factorRecuperacion = 3718.88;
            this._factorAdeudos = 14875.51;
            //TO DO: traer niveles de fuente externa
            this._niveles = [
                {
                    nombre: $f0d540db358c20b7$export$8250b6f35bc15c68.alpha,
                    coberturas: [
                        $f0d540db358c20b7$export$6e7b439551acada7.investigacionRpp,
                        $f0d540db358c20b7$export$6e7b439551acada7.firmaDeContrato,
                        $f0d540db358c20b7$export$6e7b439551acada7.investigacionRG,
                        $f0d540db358c20b7$export$6e7b439551acada7.gestionExtrajudicial,
                        $f0d540db358c20b7$export$6e7b439551acada7.recuperacionInmueble,
                        $f0d540db358c20b7$export$6e7b439551acada7.recuperacionDeAdeudos
                    ]
                },
                {
                    nombre: $f0d540db358c20b7$export$8250b6f35bc15c68.alphaPlus,
                    coberturas: [
                        $f0d540db358c20b7$export$6e7b439551acada7.investigacionRpp,
                        $f0d540db358c20b7$export$6e7b439551acada7.firmaDeContrato,
                        $f0d540db358c20b7$export$6e7b439551acada7.investigacionRG,
                        $f0d540db358c20b7$export$6e7b439551acada7.gestionExtrajudicial,
                        $f0d540db358c20b7$export$6e7b439551acada7.recuperacionInmueble,
                        $f0d540db358c20b7$export$6e7b439551acada7.recuperacionDeAdeudos,
                        $f0d540db358c20b7$export$6e7b439551acada7.seguro
                    ]
                },
                {
                    nombre: $f0d540db358c20b7$export$8250b6f35bc15c68.lite,
                    coberturas: [
                        $f0d540db358c20b7$export$6e7b439551acada7.investigacionRG,
                        $f0d540db358c20b7$export$6e7b439551acada7.gestionExtrajudicial,
                        $f0d540db358c20b7$export$6e7b439551acada7.recuperacionInmueble
                    ]
                }
            ];
            this.nivelCobertura = this._niveles.find((niv)=>niv.nombre === nivelCobertura) ? this._niveles.find((niv)=>niv.nombre === nivelCobertura) : this._niveles[0];
            // axios("https://www.lycklig.com.mx/products/platos-rosa-con-dorado.json")
            //   .then((data) => console.log(data.data))
            //   .catch((err) => console.log(err));
            //setear a 0 costos
            this.costoInvestigacion = 0;
            this.costoSeguro = 0;
            this.costoFirma = 0;
            this.costoInvestigacionRg = 0;
            this.costoIncumplimiento = 0;
            this.costoRecuperacion = 0;
            this.costoAdeudos = 0;
            //setear a 0 cotización
            this._costoDeVentas = 0;
            this._utilidad = 0;
            this.precioDeVentas = 0;
            this.precioDeVentasMasIVA = 0;
            this._comisionInmobiliaria = 0;
            this.calcularCostos();
            this.cotizar();
            console.log("Terminando");
            resolve();
        });
    }
    async getCpData(cp) {
        const ciudad = await fetch(`https://acromatico-cp.uc.r.appspot.com/api/cp/${cp}`, {
            headers: {
                "X-Acromatico-JWT-Token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2wiOiJBZG1pbiIsImlkIjoiMTIzNDU2In0.lU5p4VREH8qVitzPaNmteGGmtpJA8PwiSNrHkhhJC1o"
            }
        });
        const ciudadData = await ciudad.json();
        return ciudadData;
    }
    calculoUtilidad(renta) {
        let resultado;
        if (renta <= 7000) resultado = 0.0428826023 * renta + 2412;
        else if (renta <= 8205.162) resultado = -0.0128826023 * renta + 2762;
        else if (renta <= 90000) resultado = 0.3295 * renta;
        else resultado = 0.23308 * renta + 8684;
        if (renta <= 7000) resultado += 350;
        else if (renta <= 40000) resultado += 0.05 * renta;
        else resultado += 2000;
        resultado = resultado - 821.86;
        return resultado;
    }
    calcularCostos() {
        this.costoInvestigacion = this.nivelCobertura?.coberturas.find((cober)=>cober === $f0d540db358c20b7$export$6e7b439551acada7.investigacionRpp) ? this._factorInvestigacion * this.estadoGarantia : 0;
        this.costoSeguro = this.nivelCobertura?.coberturas.find((cober)=>cober === $f0d540db358c20b7$export$6e7b439551acada7.seguro) ? this._factorSeguro * this.renta : 0;
        this.costoFirma = this.nivelCobertura?.coberturas.find((cober)=>cober === $f0d540db358c20b7$export$6e7b439551acada7.firmaDeContrato) ? this._factorFirma * this.estadoFirma : 0;
        this.costoInvestigacionRg = this.nivelCobertura?.coberturas.find((cober)=>cober === $f0d540db358c20b7$export$6e7b439551acada7.investigacionRG) ? this._factorSolvencia * this._investigacionRg : 0;
        this.costoIncumplimiento = this.nivelCobertura?.coberturas.find((cober)=>cober === $f0d540db358c20b7$export$6e7b439551acada7.gestionExtrajudicial) ? this._factorIncumplimiento * this._perfilRiesgoIncumplimiento : 0;
        this.costoRecuperacion = this.nivelCobertura?.coberturas.find((cober)=>cober === $f0d540db358c20b7$export$6e7b439551acada7.recuperacionInmueble) ? this._factorRecuperacion * this._perfilRiesgoJuicioRecuperacion : 0;
        this.costoAdeudos = this.nivelCobertura?.coberturas.find((cober)=>cober === $f0d540db358c20b7$export$6e7b439551acada7.recuperacionDeAdeudos) ? this._factorAdeudos * this._perfilRiesgoJuicioAdeudos : 0;
    }
    cotizar() {
        this._costoDeVentas = this.costoInvestigacion + this.costoSeguro + this.costoFirma + this.costoInvestigacionRg + this.costoIncumplimiento + this.costoRecuperacion + this.costoAdeudos;
        this._utilidad = this.calculoUtilidad(this.renta);
        let precioVentasTemp = this._utilidad + this._costoDeVentas;
        // Minimo de precio de venta ed de $3500 ya con IVA
        if (precioVentasTemp * 1.16 < 3500) precioVentasTemp = 3500 / 1.16;
        this.precioDeVentas = Math.floor(precioVentasTemp * 100) / 100;
        this.precioDeVentasMasIVA = Math.floor(this.precioDeVentas * 1.16 * 100) / 100;
        this.precioDeVentasMasIVA = Math.ceil(this.precioDeVentasMasIVA / 10) * 10;
        this.precioDeVentas = Math.floor(this.precioDeVentasMasIVA / 1.16 * 100) / 100;
        this._comisionInmobiliaria = Math.floor(this.precioDeVentasMasIVA * 10) / 100;
        return this.precioDeVentasMasIVA;
    }
    cambiarRenta(renta) {
        this.renta = renta;
        this.calcularCostos();
        return this.cotizar();
    }
    cambiarEstadoGarantia(estado) {
        this.estadoGarantia = estado;
        this.calcularCostos();
        return this.cotizar();
    }
    cambiarEstadoFirma(estado) {
        this.estadoFirma = estado;
        this.calcularCostos();
        return this.cotizar();
    }
    cambiarNivel(nivel) {
        this.nivelCobertura = this._niveles.find((niv)=>niv.nombre === nivel) ? this._niveles.find((niv)=>niv.nombre === nivel) : this._niveles[0];
        this.calcularCostos();
        return this.cotizar();
    }
}


export {$f0d540db358c20b7$export$f566b60ae4e8e0b3 as EstadoEnGarantia, $f0d540db358c20b7$export$4d1c8da1ae941898 as EstadoFirma, $f0d540db358c20b7$export$8250b6f35bc15c68 as NivelCobertura, $f0d540db358c20b7$export$6e7b439551acada7 as Coberturas, $f0d540db358c20b7$export$3bbcb4831e58d00d as Cotizador};
//# sourceMappingURL=index.js.map
